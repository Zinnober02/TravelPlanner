# 旅游规划系统设计文档

## 一、项目概述

### 1.1 技术架构说明

#### 后端技术栈
- JDK版本：21
- 框架：SpringBoot 3.5.7
- 工具库：Lombok、SLF4J
- 异常处理：全局错误处理器，业务失败直接抛出异常，由全局异常统一返回前端
- 数据库使用supabase的云数据库，增删改查基于其提供的restful api进行，使用webclient进行http请求。

#### 前端技术栈
- 框架：Vue3 组合式API
- UI组件库：Element-Plus
- 网络请求：Axios
- 开发模式：HTML中直接开发，非Vue脚手架项目

#### 数据库
- 服务：Supabase 云数据库
- 访问方式：RESTful API（非JDBC），这是api参考文档：[Supabase API 文档](./supabase_api.md)

#### AI服务
- 大语言模型：阿里云百炼 qwen-flash 模型
- SDK依赖：
```xml
<!-- 阿里云百炼SDK依赖 -->
<dependency>
    <groupId>com.alibaba</groupId>
    <artifactId>dashscope-sdk-java</artifactId>
    <version>2.21.14</version>
</dependency>
```

#### 第三方服务集成
- 语音识别：科大讯飞语音识别API
- 地图服务：高德或百度地图API

### 1.2 部署架构
- 前后端一体化部署：前端作为后端项目的Web资源，统一部署

### 1.3 接口规范
- RESTful API 设计
- 统一返回格式：{"code": 0, "message": "success", "data": {}}，不再使用Spring的ResponseEntity，统一使用自定义的Result类。
- 用户认证：除登录注册页面外，未登录用户访问其他页面需重定向至登录页

## 二、核心功能模块

### 2.1 智能行程规划
提供多种方式输入旅行需求，由AI生成个性化旅行路线：

#### 输入方式
1. 表单填写：
   - 目的地
   - 出行日期
   - 预算金额
   - 同行人数
   - 旅行偏好（可选）

2. 自然语言输入：
   - 文字输入示例："我想去日本，5天，预算1万元，喜欢美食和动漫，带孩子"
   - 语音输入：语音转文字后可微调

#### 输出内容
- 个性化旅行路线
- 交通安排
- 住宿推荐
- 景点游览
- 餐厅建议

#### 处理流程
用户语音输入 → 语音转文字 → 用户手动文本微调（可选） → 调用AI生成规划
或者
用户填写表单 → 提交表单 → 调用AI生成规划

> 注意：语音记录不存储，仅用于实时转换

### 2.2 费用预算与管理
- AI预算分析功能
- 旅行开销记录（支持语音录入）

### 2.3 用户管理系统
- 用户注册与登录
- 多份旅行计划的保存与管理
- 用户状态维护（可使用ThreadLocal保存当前登录用户ID）

## 三、开发要求

### 3.1 前端开发规范
- 所有网络请求集中管理（建议放在同一JS文件中）
- 地图为主的交互界面设计
- 清晰的行程展示
- 美观的图片呈现

### 3.2 后端开发规范
- 全局异常处理机制
- 统一返回结果封装
- RESTful API 设计
- 安全的用户认证机制

### 3.3 设计文档要求
需要提供以下设计文档：
1. 系统框架设计
2. 数据库表设计
3. RESTful API 设计